{% extends "layout.html" %}
{% block title %}{% if query %}{{ query }} - Search{% else %}Search{% endif %}{% endblock %}

{% block content %}
{% if query %}
<p>
This is a search for <code>{{ query }}</code>. In the JSON Source view, alt-click will open and close full subtrees.
</p>
<ul>
{% for result in data.hits.hits %}
<li style="clear: left" class="result">
  <h4><a href="/{{ result._index}}/{{ result._id }}">{{ result._index }} / {{ result._id }}</a> <button class="btn json-expander closed">{{ expand_icon() }} JSON Source</button></h4>
  <div class="raw collapse">{{ json_pp(result._source) }}</div>
</li>
{% endfor %}
</ul>
{% endif %}
{% endblock %}

{% block js %}
{{ expander_js() }}
<script>
  $('button.json-expander').click(function() {
    $(this).find('i').toggleClass('icon-plus icon-minus'); 
    $(this).closest('li.result').find('div.raw').toggleClass('collapse');
  });
</script>
{% endblock %}
